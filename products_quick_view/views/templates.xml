<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="odassets_frontend" inherit_id="website.assets_frontend">
     <xpath expr="script[last()]" position="after">
     	<script type="text/javascript" src="/products_quick_view/static/src/js/quick_view.js"/>
     </xpath>
    </template>
    <template id="quick_view" name="Quick View Container">
        <div class="d-flex align-content-center flex-wrap">
        	  <t t-set="combination" t-value="product._get_first_possible_combination()"/>
            <t t-set="combination_info"
               t-value="product._get_combination_info(combination, add_qty=add_qty or 1, pricelist=pricelist)"/>
            <t t-set="product_variant" t-value="product.env['product.product'].browse(combination_info['product_id'])"/>
            <section
                    t-attf-class="container-fluid py-2 oe_website_sale #{'discount' if combination_info['has_discounted_price'] else ''}"
                    id="product_detail">
                <div class="row oe_website_sale">
                    <div class="col-md-6 col-xl-6">
                        <t t-call="website_sale.shop_product_carousel"/>
                    </div>
                    <div class="col-md-6 col-xl-6" id="product_details">
                        <h2 itemprop="name" t-field="product.name" class="">Product Name</h2>
                        <div class="o_not_editable">
                            <p t-field="product.description_sale" class=""/>
                        </div>
                        <span itemprop="url" style="display:none;" t-esc="product.website_url"/>
                        <form t-if="product._is_add_to_cart_possible()" action="/shop/cart/update" method="POST">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <div class="js_product js_main_product">
                                <t t-call="website_sale.product_price"/>
                                <t t-placeholder="select">
                                    <input type="hidden" class="product_id" name="product_id"
                                           t-att-value="product_variant.id"/>
                                    <input type="hidden" class="product_template_id" name="product_template_id"
                                           t-att-value="product.id"/>
                                    <t t-if="combination" t-call="sale.variants">
                                        <t t-set="ul_class" t-value="'flex-column'"/>
                                        <t t-set="parent_combination" t-value="None"/>
                                    </t>
                                    <t t-else="">
                                        <ul class="d-none js_add_cart_variants"
                                            t-att-data-attribute_exclusions="{'exclusions: []'}"/>
                                    </t>
                                </t>

                                <p t-if="True" class="css_not_available_msg alert alert-warning">This combination does
                                    not exist.
                                </p>
                                <t t-set="qty_show"
                                   t-value="request.website.viewref('website_sale.product_quantity').active"/>
                                <t t-set="buy_now_show"
                                   t-value="request.website.viewref('website_sale.product_buy_now').active"/>
                                <t t-if="qty_show">
                                    <div class="css_quantity input-group oe_website_spinner"
                                         contenteditable="false">
                                        <div class="input-group-prepend">
                                            <a t-attf-href="#" class="btn btn-secondary js_add_cart_json"
                                               aria-label="Remove one"
                                               title="Remove one">
                                                <span class="fa fa-minus"/>
                                            </a>
                                        </div>
                                        <input type="text" class="form-control quantity" data-min="1" name="add_qty"
                                               value="1"/>
                                        <div class="input-group-append">
                                            <a t-attf-href="#" class="btn btn-secondary float_left js_add_cart_json"
                                               aria-label="Add one" title="Add one">
                                                <span class="fa fa-plus"/>
                                            </a>
                                        </div>
                                    </div>
                                </t>
                                <a role="button" class="btn btn-primary btn-lg mt16 a-submit qv-addcart" href="#">
                                    <span class="fa fa-shopping-cart"/>
                                    Add to Cart
                                </a>
                                <t t-if="buy_now_show">
                                    <a role="button" id="buy_now"
                                       class="btn btn-outline-primary btn-lg mt16 d-block d-sm-inline-block" href="#">
                                        <span class="fa fa-bolt"/>
                                        Buy Now
                                    </a>
                                </t>
                                <div class="availability_messages o_not_editable"/>
                                <div id="product_option_block"/>
                            </div>
                        </form>
                        <p t-elif="not product.active" class="alert alert-warning">This product is no longer
                            available.
                        </p>
                        <p t-else="" class="alert alert-warning">This product has no valid combination.</p>
                    </div>
                </div>
            </section>
        </div>
    </template>
    <!-- Quick view in shop -->
    <template id="quickview_icon_shop_product_item" inherit_id="website_sale.products_item" customize_show="True" active="False" name="Quick view">
        <xpath expr="//div[hasclass('o_wsale_product_btn')]" position="inside">
            <a class="btn btn-secondary quick-view-show" href="#"
               t-att-data-id="'%s' % product.id">
                <span class="fa fa-eye"/>
            </a>
        </xpath>
    </template>
    <template id="quickview_modalpopup" inherit_id="website_sale.products">
        <xpath expr="//div[hasclass('o_wsale_products_main_row')]" position="after">
             <div class="modal fade" id="quick_view_model" tabindex='-1'>
            <div class="modal-dialog modal-lg modal-dialog-centered">
                <div class="modal-content">
                    <button type="button" class="close text-right p-2" data-dismiss="modal"
                                aria-label="Close" tabindex="-1">
                                <i class="fa fa-close"></i>
                    </button>
                    <div class="modal-body">
                    </div>
                </div>
            </div>
        </div>
        </xpath>
    </template>
</odoo>
